// Package main содержит ответ на задачу о поиске на карте за константное время.
//
// Исходная задача:
// Есть две точки на карте (долгота и широта), допустим они обозначают местоположение платной парковки.
// Необходимо осуществить поиск точек на карте за константное время O(1)
// с возвратом из функции ParkingSearch() true в случае совпадения.
// Вопрос: какой тип данных Вы будете использовать?
package main

import (
	"fmt"
)

// Point представляет собой точку на карте с широтой (Lat) и долготой (Lon).
// Эта структура будет использоваться в качестве ключа в нашей карте.
// Структуры в Go являются сравниваемыми типами, если все их поля также сравниваемы,
// поэтому их можно использовать как ключи в map.
type Point struct {
	Lat float32
	Lon float32
}

// parkingSet — это наше хранилище парковок для поиска за O(1).
//
// Ответ на задачу: Для обеспечения поиска за константное время O(1) идеальным
// выбором является хеш-карта (в Go это `map`). Среднее время доступа к элементу
// в хеш-карте не зависит от количества элементов в ней.
//
// В качестве значения мы используем `bool` или пустую структуру `struct{}`,
// так как нам важен только факт наличия ключа в карте (множество/set).
var parkingSet map[Point]bool

// init() — специальная функция Go, которая выполняется один раз при запуске пакета.
// Мы используем ее для предварительного заполнения нашего набора данных о парковках.
func init() {
	parkingSet = make(map[Point]bool)
	// Добавление двух примеров парковок.
	addParking(Point{Lat: 35.69083, Lon: 139.75856})
	addParking(Point{Lat: 55.75222, Lon: 37.61556})
}

// addParking добавляет новую парковку в наш набор.
func addParking(p Point) {
	parkingSet[p] = true
}

// ParkingSearch осуществляет поиск парковки по координатам за O(1).
//
// ВАЖНОЕ ЗАМЕЧАНИЕ о числах с плавающей точкой:
// Использование float в качестве ключей (даже внутри структуры) сопряжено с риском.
// Из-за особенностей представления чисел с плавающей точкой в памяти,
// `35.69083` и `35.690831` могут считаться разными ключами.
// В реальных системах вместо поиска точного совпадения обычно ищут точки
// в определенном радиусе или используют геохеши (например, алгоритм S2 или Geohash).
// Для данной учебной задачи предполагается, что координаты на входе и в хранилище идентичны.
func ParkingSearch(p Point) bool {
	// Поиск в map — это операция со средней сложностью O(1).
	_, exists := parkingSet[p]
	return exists
}

func main() {
	fmt.Println("--- Проверка наличия парковок ---")

	// Тестовые точки
	tokyoParking := Point{Lat: 35.69083, Lon: 139.75856}
	moscowParking := Point{Lat: 55.75222, Lon: 37.61556}
	newYork := Point{Lat: 40.71278, Lon: -74.00594}

	// Проверяем, существует ли парковка с такими координатами
	fmt.Printf("Парковка в Токио (%v): %t\n", tokyoParking, ParkingSearch(tokyoParking))   // true
	fmt.Printf("Парковка в Москве (%v): %t\n", moscowParking, ParkingSearch(moscowParking)) // true
	fmt.Printf("Парковка в Нью-Йорке (%v): %t\n", newYork, ParkingSearch(newYork))       // false
}
